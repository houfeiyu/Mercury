<!-- 2018-1-23 16:23:54 | 版权所有 合肥火星科技有限公司 http://www.marsgis.cn  【联系我们QQ：516584683】 -->
<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no"><title></title><script src="../../../lib/include-lib.js?time=20180123" libpath="../../../lib/" include="jquery,font-awesome,bootstrap,bootstrap-table,layer,haoutil"></script><link href="../../css/widget-win.css" rel="stylesheet"><link href="view.css" rel="stylesheet"></head><body><div class="mp_head"><ul><li id="btn_marker_Add"><i class="fa fa-edit" title="添加注记"></i></li><li class="ml10">|</li><li id="btn_plot_openfile"><i class="fa fa-folder-open-o" title="打开文件"></i></li><li id="btn_plot_openfile2"><i class="fa fa-folder-open" title="叠加文件"></i></li><li id="btn_plot_savefile"><i class="fa fa-save" title="保存文件"></i></li><li class="ml10">|</li><li id="btn_plot_delall"><i class="fa fa-trash" title="清空标绘"></i></li><li id="btn_plot_isedit"><i class="fa fa-unlock" title="是否可编辑"></i></li></ul><input id="input_plot_file" type="file" accept=".json" style="display:none"></div><table id="table"></table><script>function getHeight(){return $(window).height()-40}function initWidgetView(t){thisWidget=t,plotFile.initEvent(),$("#btn_marker_Add").bind("click",function(){thisWidget.drawPoint()}),$("#btn_plot_delall").click(function(){thisWidget.deleteAll(),refMarkerList()});var e=!0;$("#btn_plot_isedit").click(function(){e=!e,e?($(this).removeClass("active"),$(this).children().removeClass("fa-lock").addClass("fa-unlock")):($(this).addClass("active"),$(this).children().removeClass("fa-unlock").addClass("fa-lock")),thisWidget.hasEdit(e)}),$table=$("#table"),$table.bootstrapTable({height:getHeight(),singleSelect:!0,pagination:!1,pageSize:6,iconsPrefix:"fa",columns:[{field:"name",title:"名称",sortable:!0,editable:!1,align:"left"},{field:"operate",title:"操作",align:"center",width:50,events:{"click .remove":function(t,e,i,l){thisWidget.deleteEditFeature(i.id)}},formatter:function(t,e,i){return['<a class="remove" href="javascript:void(0)" title="删除">','<i class="fa fa-trash"></i>',"</a>"].join("")}}],onClickRow:function(t,e,i){thisWidget.centerAt(t.id)}}),refMarkerList()}function refMarkerList(){var t=thisWidget.getMarkerDataList();$table.bootstrapTable("load",t)}var thisWidget,$table,plotFile={initEvent:function(){var t,e=this;$("#btn_plot_openfile").click(function(){t=!0,$("#input_plot_file").click()}),$("#btn_plot_openfile2").click(function(){t=!1,$("#input_plot_file").click()}),$("#btn_plot_savefile").click(function(){var t=thisWidget.getJsonData();null==t||""==t?haoutil.msg("当前未标记任何数据！"):haoutil.file.downloadFile("我的标记.json",t)}),$("#input_plot_file").change(function(i){var l=this.files[0],n=l.name,a=n.substring(n.lastIndexOf(".")+1,n.length).toLowerCase();if("json"!=a)return haoutil.msg("文件类型不合法,请选择json格式标注文件！"),void e.clearPlotFile();if(window.FileReader){var o=new FileReader;o.readAsText(l,"UTF-8"),o.onloadend=function(i){var l=this.result;thisWidget.jsonToLayer(l,t),e.clearPlotFile()}}})},clearPlotFile:function(){window.addEventListener?document.getElementById("input_plot_file").value="":document.getElementById("input_plot_file").outerHTML+=""}}</script></body></html>