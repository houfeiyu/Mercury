/* 2017-12-19 10:25:36 | 版权所有 合肥火星科技有限公司 http://www.marsgis.cn  【联系我们QQ：516584683】 */
L.widget.bindClass(L.widget.BaseWidget.extend({map:null,options:{view:{type:"window",url:"view.html",windowOptions:{width:250}}},workDraw:null,layerDraw:null,create:function(){var t=this;this.workDraw=new L.mars.Draw({map:this.map,isOnly:!1,hasDel:!0,style:{color:"#ff0000",weight:2},onEvnet:!1,onCreate:function(i){t.viewWindow.plotlist.plotEnd()},onChange:function(i){var n=t.workDraw.currEditFeature,r=L.mars.layer.getLatlngs(n);n.constructor===L.Circle?t.startEditing(n):t.viewWindow.plotEdit.updateLatlngsHtml(r)},onStartEditing:function(i){t.startEditing(i)},onStopEditing:function(i){t.stopEditing(i)}}),this.layerDraw=this.workDraw.getLayer()},viewWindow:null,winCreateOK:function(t,i){this.viewWindow=i},activate:function(){this.workDraw.onEvnet(),this.map.addLayer(this.layerDraw),bindToLayerControl(this.config.name,this.layerDraw)},disable:function(){this.workDraw.destroy(!0)},startDraw:function(t){this.workDraw.startDraw(t.type,t)},_last_layer:null,startEditing:function(t){this._last_layer=t;var i=L.mars.layer.getLatlngs(t);this.viewWindow.plotEdit.startEditing(t.properties,i)},stopEditing:function(t){this.viewWindow.plotEdit.stopEditing()},updateAttr2map:function(t){this.workDraw.updateProperties(this._last_layer,t)},getGeoJson:function(){return this.workDraw.toJson()},jsonToLayer:function(t,i){return this.workDraw.jsonToLayer(t,i)},deleteAll:function(){this.workDraw.clearDraw()},hasEdit:function(t){this.workDraw.hasEdit(t)}}));